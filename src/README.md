Add the latest version of the functioning code here
